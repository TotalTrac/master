SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
--region [job].[DataProcessingItemsGetAll]

------------------------------------------------------------------------------------------------------------------------
-- Generated By:   dlaub using CodeSmith 6.0.0.0
-- Template:       StoredProcedures.cst
-- Procedure Name: [job].[DataProcessingItemsGetAll]
-- Date Generated: Monday, February 29, 2016
------------------------------------------------------------------------------------------------------------------------

CREATE PROCEDURE [job].[DataProcessingItemsGetAllReadyByDateRange]
    @From		datetime = NULL
	, @To		datetime = NULL
AS  

SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ COMMITTED

SELECT
	dpi.[Id],
	[AnalysisType],
	[DataServiceType],
	[Description],
	dpi.[KitId],
  [MatchTypeId],
	[MergePurgeType],
	[NcoaDate],
	[NcoaType],
  [ProductionTargetId],
	[ReturnFiles],
	[ReturnFileDescription],
	[SuppressionType],
  dpi.StartTime,
  dpi.EndTime,
	dpi.[RowVersion]
FROM
	[job].[DataProcessingItem] dpi
INNER JOIN job.Kits AS k ON k.Id = dpi.KitId
INNER JOIN job.KitSetupProcessGroups kspg ON k.Id = kspg.KitId
  INNER JOIN job.ProductionProcesses sp ON kspg.ProcessId = sp.Id
  WHERE sp.StopTime IS NOT NULL AND k.DropDate BETWEEN @From AND @To
--endregion
GO