SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
--region [messaging].[InstantMessagesGetByRecipientUserId]

------------------------------------------------------------------------------------------------------------------------
-- Generated By:   dlaub using CodeSmith 6.0.0.0
-- Template:       StoredProcedures.cst
-- Procedure Name: [messaging].[InstantMessagesGetByRecipientUserId]
-- Date Generated: Monday, June 5, 2017
------------------------------------------------------------------------------------------------------------------------

CREATE PROCEDURE [messaging].[InstantMessagesGetUnreadBySenderUserIdAndRecipientUserId]
	@SenderId INT,
  @RecipientId INT
AS

SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ COMMITTED

SELECT
	[Id],
	[Created],
	[CreatedById],
  IsRead,
	[Message],
	[RecipientUserId],
	[SenderUserId],
	[RowVersion]
FROM
	[messaging].[InstantMessages]
WHERE
(	[RecipientUserId] = @RecipientId AND SenderUserId = @SenderId AND (IsRead IS NULL OR IsRead = 0)) OR(	[RecipientUserId] = @SenderId AND SenderUserId = @RecipientId AND (IsRead IS NULL OR IsRead = 0))
ORDER BY Created
--endregion
GO